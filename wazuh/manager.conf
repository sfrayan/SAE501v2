<!-- 
  manager.conf - Configuration Wazuh Manager (SIMPLIFIÉE v1.4)
  
  Fichier: wazuh/manager.conf
  Auteur: GroupeNani
  Date: 31 janvier 2026
  Version: 1.4 (minimal, sans décodeurs custom)
  
  Description:
    Configuration du manager Wazuh pour la surveillance sécurité SAE 5.01.
    Version MINIMALE et ROBUSTE - À copier vers: /var/ossec/etc/ossec.conf
    
  Corrections v1.4:
    - Suppression référence décodeur (cause segfault)
    - Configuration minimale et stable
    - Désactivation modules optionnels
-->

<ossec_config>
  <!-- ============================================
       CONFIGURATION GLOBALE
       ============================================ -->
  <global>
    <email_notification>no</email_notification>
    <logall>yes</logall>
    <logall_json>yes</logall_json>
  </global>

  <!-- ============================================
       ALERTES
       ============================================ -->
  <alerts>
    <log_alert_level>3</log_alert_level>
  </alerts>

  <!-- ============================================
       LOCALFILE - COLLECTE FICHIERS LOGS
       ============================================ -->
  
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/auth.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/syslog</location>
  </localfile>

  <!-- ============================================
       INTÉGRITÉ FICHIERS
       ============================================ -->
  <syscheck>
    <frequency>86400</frequency>
    <directories check_all="yes">/etc/ssh</directories>
    <ignore>/var/ossec/logs</ignore>
    <ignore>/var/log</ignore>
  </syscheck>

  <!-- ============================================
       RÉCEPTION SYSLOG
       ============================================ -->
  <remote>
    <connection>syslog</connection>
    <port>514</port>
    <protocol>udp</protocol>
    <allowed-ips>192.168.10.0/24</allowed-ips>
    <allowed-ips>192.168.20.0/24</allowed-ips>
  </remote>

  <!-- ============================================
       CONNEXION AGENTS
       ============================================ -->
  <remote>
    <connection>secure</connection>
    <port>1514</port>
    <protocol>tcp</protocol>
    <allowed-ips>192.168.10.0/24</allowed-ips>
    <allowed-ips>192.168.20.0/24</allowed-ips>
  </remote>

  <!-- ============================================
       MODULES WAZUH (MINIMAUX)
       ============================================ -->
  
  <wodle name="vulnerability-detector">
    <disabled>yes</disabled>
  </wodle>

  <wodle name="syscollector">
    <disabled>yes</disabled>
  </wodle>

  <wodle name="osquery">
    <disabled>yes</disabled>
  </wodle>

  <!-- ============================================
       DÉCODERS & RÈGLES
       ============================================ -->
  <ruleset>
    <decoder_dir>ruleset/decoders</decoder_dir>
    <rule_dir>ruleset/rules</rule_dir>
    <rule_include>local_rules.xml</rule_include>
  </ruleset>

</ossec_config>