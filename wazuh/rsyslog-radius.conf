# rsyslog-radius.conf - Configuration rsyslog pour FreeRADIUS
# SAE 5.01 - Fitness WiFi Management
#
# Fichier: wazuh/rsyslog-radius.conf
# Auteur: GroupeNani
# Date: 2 février 2026
# Version: 1.0
#
# Description:
#   Configuration rsyslog pour capturer et rediriger les logs FreeRADIUS
#   vers Wazuh pour analyse de sécurité.
#
# Installation:
#   sudo cp wazuh/rsyslog-radius.conf /etc/rsyslog.d/30-radius.conf
#   sudo systemctl restart rsyslog
#
# Vérification:
#   logger -t freeradius "Test message"
#   sudo tail -f /var/log/freeradius/radius.log

# ==================================================
# CAPTURE LOGS FREERADIUS
# ==================================================

# Capturer tous les messages de FreeRADIUS
:programname, isequal, "freeradius" /var/log/freeradius/radius.log

# Envoyer également vers Wazuh (local port 1514 TCP)
:programname, isequal, "freeradius" @@127.0.0.1:1514

# Arrêter le traitement pour éviter la duplication dans syslog
:programname, isequal, "freeradius" stop

# ==================================================
# NOTES
# ==================================================
#
# Format:
#   :programname, isequal, "freeradius" <destination>
#
# Destinations:
#   /var/log/freeradius/radius.log   - Fichier local
#   @@127.0.0.1:1514                 - Wazuh (TCP)
#   stop                             - Arrêter traitement
#
# Redémarrage:
#   sudo systemctl restart rsyslog
#
# Vérification:
#   sudo rsyslogd -N1  # Vérifier syntaxe
#   sudo systemctl status rsyslog
